/*! Harmony v0.1pre Â© Fred Yang - semanticsworks.com | www.opensource.org/licenses/mit-license.php */(function(g,ha,r){function ya(c,b){for(var a in b)c[a]||(c[a]=b[a])}function Ya(c){return"."===c?"#":ia(c.length+2).join("#")}function za(c){if(c===x)return"";var b=Aa.exec(c);return b?b[1].replace(ja,ka):c}function ka(c){return"#"==c?".":ia(c.length).join("#")}function la(c,b,a){var d,e=c.lastIndexOf(".");i(a)&&(a=!0);if(a){-1===e?(a="",d=c):(a=c.substring(0,e),d=c.substring(e+1));for(var e=a,a=d,f=0;f<J.length;f++)J[f](e,a,b)}if(!U(b))for(d in b){for(var e=c,a=d,f=b[d],j=0;j<J.length;j++)J[j](e,
a,f);la(c+"."+d,b[d],!1)}}function Ba(c,b){var b=y(b),a=A[b];a||(A[b]=a=[]);a.pushUnique(c)}function Ca(c,b){var b=y(b),a=A[b];a.remove(c);a.length||delete A[b]}function Da(c){return(c=Za.exec(c))&&c[1]||""}function Y(){return!1}function z(){return!0}function Z(c,b,a,d,e){this.publisher=B(c);this.originalPublisher=B(b);this.originalType=this.type=a;this.proposed=d;this.removed=e}function Ea(c){var b=c.workflow,a=b.getName,b=b.getParas,c=c.publisher;return b?c[a](b):m(c[a])?c[a]():c[a]}function Fa(c,
b){var a=b.workflow,d=a.setName;(a=a.setParas)?this[d](a,c):m(this[d])?this[d](c):this[d]=c}function Ga(c,b,a){var d=K.getId(b);return g.map(c.split(L),function(b){return k(a)?b+"."+x+"."+d+"."+a:b+"."+x+"."+d+"."+K.getId(a)}).join(" ")}function B(c){return k(c)?h(c):c==M?null:q(c)&&!c.nodeType?c:g(c)}function $a(c){return"."==c?"\\.":".*"}function Ha(c){var b,a,d;d=c.publisher.subsToMe();for(a=0;a<d.length;a++){b=d[a];var e=c,f;a:{f=b.eventTypes;var j=c.type,g=void 0,h=void 0,i=h=g=void 0,k=void 0;
if("*"===f)f="*";else{f=f.split(L);for(k=0;k<f.length;k++)if(h=f[k],h=(i=Ia.test(h))?h.replace(Ia,""):h,h=h.replace(ab,$a),h=i?"^"+h:"^"+h+"$",g=new H(h),g=g.test(j))if(i){if(i="^"==h?j:H.rightContext,!i||!i.contains(".")){f=f[k];break a}}else{f=f[k];break a}f=void 0}}e.matchedType=f;c.matchedType&&$(B(b.subscriber),b.workflow,c);if(c.isImmediatePropagationStopped())return}if(!c.isCascadeStopped()&&(b=A[c.publisher.path]))for(d=0;d<b.length;d++){a=p(b[d],c.originalPublisher.path,c.type);if(a.isImmediatePropagationStopped()||
a.isImmediatePropagationStopped())break;a.hasError()&&c.error()}}function $(c,b,a,d){var e;a.workflow=b;a.subscriber=c;d=i(d)?b.get.call(c,a):b.get.apply(c,[a].concat(d));V(d)?(e=l(!0,{},a),d.done(function(d){b.convert&&(d=b.convert.call(c,d,a));if(!i(d))if(V(d))d.done(function(a){aa(c,b,a,e)});else return aa(c,b,d,a)})):(b.convert&&(d=b.convert.call(c,d,a)),i(d)||(V(d)?(e=l(!0,{},a),d.done(function(a){aa(c,b,a,e)})):aa(c,b,d,a)))}function aa(c,b,a,d){i(a)||(b.set&&b.set.call(c,a,d),b.finalize&&b.finalize.call(c,
a,d))}function N(c){c.publisher=B(c.currentTarget);c.originalPublisher=B(c.target);var b=B(c.data.subscriber),a=c.data.workflow;delete c.data;1<arguments.length?$(b,a,c,o.call(arguments,1)):$(b,a,c)}function Ja(c,b,a,d){c=c||"";if(k(c)){var e,f=c.split(L),j;if(1==f.length)if(c.startsWith("*")){e=O[c.substr(1)];if(!e)throw"common workflow "+c+" does not exist";e=l({},e)}else if(c.startsWith("#")?(e=c.substr(1),e=k(a)?v(a,e):k(b)?v(b,e):e,e=n.raw(e)):e=void 0,e)if(m(e))e=l({get:e,options:d},e);else if(q(e)&&
e.get)e=l({options:d},e);else throw"missing handler";else if(!i(b)&&!i(a)){e=k(b);f=k(a);if(e)c={get:"get",set:c||"set"};else if(f)if(c)c={get:c,set:"set"};else if(c=n.raw(a),m(c))c={get:n.raw(a)};else{if(!q(c)||!c.get)throw"missing handler";}else c={get:c,set:c};e=c}else throw"invalid handler";else{e={};for(var g=0;g<ba.length;g++)c=f[g],j=ba[g],c&&("_"!==c&&"null"!=c)&&(e[j]=c)}c=e}else if(m(c))c=l({get:c,options:d},c);else if(q(c)&&c.get)c=l({options:d},c);else throw"invalid workflow expression";
e=c;f=e.initialize;if(k(f))if(f.startsWith("*")){if(f=h.activity.initialize[f.substring(1)],!f)throw"initialize activity does not exist!";}else{var na=f;if(!n.raw(na))throw"initialize activity does not exist at path "+na;f=function(a,b,c,d){n.set(na,a,b,c,d)}}f?(f(B(b),B(a),e,d),delete e.initialize):i(d)||(e.options=d);ca("get",c,b,a);ca("set",c,b,a);W(c,"convert");W(c,"finalize");return c}function Ka(c){var b;if(k(c)){var a=c.split(L),d;if(1<a.length)for(var c={},e=0;e<ba.length;e++)b=a[e],d=ba[e],
b&&("_"!==b&&"null"!=b)&&(c[d]=b);else throw"invalid workflow type";b=c}else if(m(c)||q(c)&&c.get)b=c,m(c)&&(b=l({get:c},b));else throw"invalid workflow expression";W(b,"initialize");ca("get",b);ca("set",b);W(b,"convert");W(b,"finalize");return b}function ca(c,b,a,d){var e=b[c];if(e&&k(e)){var f=h.activity[c];if(e.startsWith("*")){if(e=e.substr(1),b[c]=f[e],!b[c])throw e+" does not exists "+c+" Activity";}else if(e=e.split("*"),b[c]="get"==c?Ea:Fa,b[c+"Name"]=e[0],e[1]&&(b[c+"Paras"]=e[1]),!i(a)&&
!i(d)){var b=e[0],a="get"==c?a:d,j;k(a)?oa[b]||(j=!0):a.nodeType?P[b]||(j=!0):b in a||(j=!0);if(j)throw("get"==c?"publisher":"subscriber")+" does not have a member "+b;}}}function W(c,b){var a=c[b];if(k(a))if(a.startsWith("*")){if(c[b]=h.activity[b][a.substr(1)],!c[b])throw a+"Activity does not exists";}else c[b]=function(){return n.raw(a).apply(this,arguments)}}function La(c){if(q(c)){if(!K.getId(c))return;K.unMark(c)}w.removeBy(c)}function pa(c,b){if("_"!==b)return b&&b.startsWith("_")?b.substr(1):
c||b}function D(c,b,a,d){var e,f;if(c)if(c.nodeType){if(d=c,c=g.trim(g(d).attr(E.subsAttr))){b=new D;b.elem=d;a=b;a:{for(d=g(d);(d=d.parent())&&d.length;)if(e=d.hmData("ns"),!i(e)){d=e;break a}d=""}a.ns=d;return new D(c,b)}}else{if(!b)return b=new D,b.elem={},new D(c,b);this.sub=[];this.pub=[];for(this.groups=[];f=bb.exec(c);){var j=f[1],h=f[2];f=f[3];var k={key:h,value:f};j?this["$"==j?"pub":"sub"].push(k):"ns"==h?e=f:this.groups.push(k)}this.ns=v(v(b.ns,a),e);this.text=c;this.elem=b.elem;this.subscriptions=
b.subscriptions;b.elemGroup?this.elemGroup=b.elemGroup:(this.elemGroup=this,g(this.elem).hmData("ns",this.ns));this.options=pa(b.options,d);this.importGroup();this.importSubscriptions("sub");this.importSubscriptions("pub");this.debug&&this.print()}else this.subscriptions=[]}function qa(c){var b,a,d,e=g(c);if(!e.hmData("parsed")&&e.attr(E.subsAttr)){c=new D(c);b=c.subscriptions;c.preSub&&c.preSub();for(a=0;a<b.length;a++)d=b[a],h.sub(d.subscriber,d.publisher,d.eventTypes,d.handler,d.options,d.delegate);
c.postSub&&c.postSub();e.hmData("parsed",!0)}e.children().each(function(){qa(this)})}function Ma(c,b,a){return l({},ra,q(c)?c:{get:c,set:b,finalize:a})}function Na(c){this.modelPath=c.publisher.path;this.e=c}function Oa(c){c=c||Q.defaultEngine;if(!c)throw"engine name is not specified or default engine name is null";c=da[c];if(!c)throw"engine '"+c+"' can not be found.";return c}function Pa(c){c=c[0];return"true"==c.value?!0:"false"==c.value?!1:"on"!==c.value?c.value:c.checked}function Qa(c,b,a,d){a:{var e,
f;if(a)for(e=R.length-1;0<=e;e--){if(f=R[e],f.name==a){a=f;break a}}else for(e=R.length-1;0<=e;e--)if(f=R[e],f.match&&f.match(c)){a=f;break a}a=void 0}if(!a||!a[d])throw"can not find "+d+" method for view";b[d+"ViewValue"]=a[d];a.convert&&(b.convert=a.convert);c.hmData("valueBound")||(a.initialize&&a.initialize(c),c.hmData("valueBound",!0))}var h=ha.hm=function(c,b){return new sa(c,b)},sa=function(c,b){this.path=y(c||"",!0);i(b)||this.set(b)},oa,l=g.extend,ta={},F=g.isArray,m=g.isFunction,cb={undefined:r,
"boolean":r,number:r,string:r},x="__hm",Aa=/^__hm\.([^\.]+?)(?:\.|$)/,db=/this\.(?:get)\s*\(\s*(['"])([\*\.\w\/]+)\1\s*\)/g,A={},E={},n,X=ta[x]={},eb=ta.hasOwnProperty,ia=ha.Array,Ra=ia.prototype,fb=String.prototype,o=Ra.slice,p,gb=/^(?:\{.*\}|\[.*\])$/,hb=/^\.(\.*)([\.\*])/,ib=/^\.<(.*)/,Sa=/^[\.\*]/,jb=/[\.\*]/,kb=/#+|\./g,ja=/#+/g,H=ha.RegExp,Za=/^(.+)[\.\*]\w+$/,v,lb=/^.+\.(\w+)$|\w+/,C,i,U,k,q,S,ua=g.isNumeric,V,ea,y,G,Ta,P=g.fn,mb=/\{([^\{\}]*)\}/g;ya(Ra,{indexOf:function(c,b){for(var a=b||
0;a<this.length;a++)if(this[a]==c)return a;return-1},contains:function(c){return-1!==this.indexOf(c)},remove:function(c){c=this.indexOf(c);-1!=c&&this.splice(c,1);return this},removeAt:function(c){this.splice(c,1);return this},pushUnique:function(c){this.contains(c)||this.push(c);return this},merge:function(c){if(c&&c.length)for(var b=0;b<c.length;b++)this.pushUnique(c[b]);return this},sortObject:function(c,b){i(b)&&(i(c)?(b=!0,c=r):k(c)?b=!0:(b=c,c=r));c?this.sort(function(a,d){var e=a[c],f=d[c];
return e==f?0:b?e>f?1:-1:e>f?-1:1}):b?this.sort():this.sort().reverse();return this}});ya(fb,{startsWith:function(c){return 0===this.indexOf(c)},contains:function(c){return-1!==this.indexOf(c)},endsWith:function(c){return-1!==this.indexOf(c,this.length-c.length)},supplant:function(c){return this.replace(mb,function(b,a){var d=c[a];return typeof d?d:b})},format:function(){var c=this;g.each(arguments,function(b,a){c=c.replace(new H("\\{"+b+"\\}","g"),a)});return c}});oa=sa.prototype=h.fn=h.prototype=
{constructor:sa,get:function(c){var b;if(b=this.accessor(c,!0)){if(m(b.hostObj))return b.hostObj.apply(this.cd(".."),o.call(arguments));b=!b.index?b.hostObj:b.hostObj[b.index];return m(b)?b.apply(this.cd(c).cd(".."),o.call(arguments,1)):b}},getJson:function(){return JSON.stringify(this.get.apply(this,o.call(arguments)))},raw:function(c,b){var a;m(c)&&(b=c,c="");if(b)return a=this.accessor(c),a.index in a.hostObj?this.update(c,b,a):this.create(c,b,a);if(a=this.accessor(c,!0))return!a.index?a.hostObj:
a.hostObj[a.index]},set:function(c,b,a){if(1==arguments.length){if(""==this.path)throw"root object can not changed";n.set(this.path,c,b);return this}var d=o.call(arguments);if(S(c)){if(2==arguments.length)return n.set(c,this.path,b),this}else a=b,b=c,c=!1;var e=this.accessor(b),f=e.hostObj[e.index];return m(f)?(f.apply(this.cd(b).cd(".."),o.call(d,1)),this):e.index in e.hostObj?this.update(c,b,a,e):this.create(c,b,a,e)},accessor:function(c,b){0===c&&(c="0");var a,d,e=ta,f=this.getPath(c),j=y(f,!0),
g=j.split(".");if(1===g.length)d=j;else{d=g[g.length-1];for(a=0;a<g.length-1&&!(e=e[g[a]],e===r);a++);}if(U(e)){if(b)return;throw"invalid update on unreachable node '"+G(f)+"'";}return{physicalPath:j,hostObj:e,index:d}},create:function(c,b,a,d){S(c)||(d=a,a=b,b=c,c=!1);var d=d||this.accessor(b),b=d.physicalPath,e=d.hostObj,f=d.index,j=F(e);if(j&&ua(f)){if(f>e.length)throw"you can not add item with hole in array";}else if(f in e)throw"value at path: '"+G(d.physicalPath)+"' has been defined, try use update method instead";
if(!c&&p(b,b,"beforeCreate",a).hasError())return!1;j&&ua(f)?f==e.length?e[f]=a:f<e.length&&e.splice(d.index,0,a):e[d.index]=a;p(b,b,"afterCreate",a);la(b,a);return this},extend:function(c,b){var a;b?a=this.cd(c):(b=c,a=this);for(var d in b)a.set(d,b[d]);return this},update:function(c,b,a,d){if(1==arguments.length){if(""==this.path)throw"root object can not updated";n.update(this.path,c);return this}if(S(c)){if(2==arguments.length)return n.update(c,this.path,b),this}else d=a,a=b,b=c,c=!1;d=d||this.accessor(b);
if(!(d.index in d.hostObj))throw"value at path: '"+G(d.physicalPath)+"' has been not defined, try use create method instead";var e=d.physicalPath,f=d.hostObj[d.index];if(f==a)return this;if(!c&&p(e,e,"beforeUpdate",a,f).hasError())return!1;d.hostObj[d.index]=a;c||p(e,e,"afterUpdate",a,f);la(e,a);return this},del:function(c){if(i(c)){if(this.path)return n.del(this.path);throw"root can not be deleted";}var b=this.accessor(c),a=b.hostObj,c=b.physicalPath,d=a[b.index],e=F(a);if(p(c,c,"beforeDel",r,d).hasError())return!1;
e?a.splice(b.index,1):delete a[b.index];for(b=0;b<fa.length;b++)fa[b](c,d);p(c,c,"afterDel",r,d);return d},createIfUndefined:function(c,b){if(i(b))throw"missing value argument";var a=this.accessor(c);return a.index in a.hostObj?this:this.create(c,b,a)},pushStack:function(c){c.previous=this;return c},cd:function(c){return this.pushStack(h(this.getPath(c)))},parent:function(){return this.cd("..")},shadow:function(){return this.cd("*")},sibling:function(c){return this.cd(".."+c)},main:function(){return this.pushStack(h(za(this.path)))},
getPath:function(c){return v(this.path,c)},logicalPath:function(c){return G(this.getPath(c))},physicalPath:function(c){return y(this.getPath(c))},pathContext:function(){return Da(this.path)},pathIndex:function(){var c=lb.exec(this.path);return c[1]||c[0]},invoke:function(c){if(0===arguments.length)throw"methodName is missing";var b=this.get();return b[c].apply(b,o.call(arguments,1))},indexOf:function(c){return this.get().indexOf(c)},contains:function(c){return-1!==this.indexOf(c)},first:function(c){return c?
this.filter(c)[0]:this.get("0")},last:function(){var c=this.get();return c[c.length-1]},push:function(c){return this.create(this.get().length,c)},pushRange:function(c){for(var b=0;b<c.length;b++)this.push(c[b]);return this},pushUnique:function(c){return!this.contains(c)?this.push(c):this},pop:function(){return this.removeAt(this.get().length-1)},shift:function(){return this.del(0)},unshift:function(c){return this.create(0,c)},insertAt:function(c,b){return this.create(c,b)},updateAt:function(c,b){return this.update(c,
b)},removeAt:function(c){return this.del(c)},move:function(c,b){var a=this.count();c!==b&&(0<=c&&c<a&&0<=b&&b<a)&&(a=this.del(c),this.insertAt(b,a),p(this.path,this.path,"move",b,c));return this},replaceItem:function(c,b){if(c==b)return this;var a=this.indexOf(c);return-1!=a?this.updateAt(a,b):this},removeItem:function(c){c=this.indexOf(c);return-1!==c?this.removeAt(c):this},removeItems:function(c){for(var b=0;b<c.length;b++)this.removeItem(c[b]);return this},clear:function(){var c=this.get(),b=c.splice(0,
c.length);p(this.path,this.path,"afterCreate",c,b);return this},count:function(){return this.get().length},filter:function(c){return g(this.get()).filter(c).get()},each:function(c,b){S(c)||(b=c,c=!1);var a,d,e,f;if(c){f=this.get();for(d=f.length-1;0<=d;d--)if(e=b(d,f[d],f),!0===e)a=!0;else if(!1===e)break;a&&this.triggerChange()}else for(d=this.count()-1;0<=d&&!(a=this.cd(d),!1===b.call(a,d,a,this));d--);return this},map:function(c){return g.map(this.get(),c)},sort:function(c,b){return p(this.path,
this.path,"afterUpdate",this.get().sortObject(c,b))},reference:function(){for(var c=0;c<arguments.length;c++)Ba(this.path,arguments[c]);return this},dereference:function(){for(var c=0;c<arguments.length;c++)Ca(this.path,arguments[c]);return this},isEmpty:function(c){c=this.get(c);return!c?!0:!F(c)?!1:0===c.length},isShadow:function(){return this.path.startsWith(x)},toJSON:function(c){return JSON.stringify(this.get(c))},compare:function(c){if(c)if(c=ea(c),k(c)){if(this.get()==c)return!0;try{return eval("this.get()"+
c)}catch(b){return!1}}else return this.get()==c;else return this.isEmpty()},saveLocal:function(c){C.local(this.getPath(c),this.get());return this},getLocal:function(c){return C.local(this.getPath(c))},restoreLocal:function(c){n.set(this.getPath(c),this.getLocal(c));return this},clearLocal:function(c){C.local(this.getPath(c),r);return this}};var J=[function(c,b,a){if(m(a)&&(!a.name||!a.name.startsWith("_"))){for(var b=c?c+"."+b:b,d=a.toString(),e,a=[];e=db.exec(d);)a.pushUnique(e[2]);for(d=0;d<a.length;d++)Ba(b,
c?v(c,a[d]):a[d])}}],M={},va=function b(a){var d;if(!(this instanceof b))return d=new b(M),b.apply(d,arguments);if(arguments[0]===M)return this;this.initialize.apply(this,arguments);return this},T;l(va.prototype,{callProto:function(b){return this.constructor.prototype[b].apply(this,o.call(arguments,1))},callBase:function(b){T=T||this;if(T=T.constructor.__super__){var a=T[b].apply(this,o.call(arguments,1));T=null;return a}},initialize:function(b){l(this,b)},toJSON:function(){var b=l(!0,{},this),a;
for(a in b)a.startsWith("__")&&delete b[a];return b}});l(va,{list:function(b){var a,d,e=[],f;if(!i(b))if(F(b)){f=b.itemIsObject;for(a=0;a<b.length;a++)d=b[a],e.push(f||!F(d)?new this(d):this.apply(null,d))}else e.push(b);return e},extend:function(b,a){var d,e=this;d=b&&b.hasOwnProperty("constructor")?b.constructor:function ma(){var a;if(!(this instanceof ma))return a=new ma(M),ma.apply(a,arguments);if(arguments[0]===M)return this;e.apply(this,arguments);return this};l(d,e,a);var f=function(){this.constructor=
d};f.prototype=e.prototype;d.prototype=new f;b&&l(d.prototype,b);d.__super__=e.prototype;return d}});l(h,{Class:va,util:C={toPhysicalPath:y=function(b,a){for(var d,e="",f="",j;d=jb.exec(b);)b=H.rightContext,f=H.leftContext,"."==d[0]?e?(e==x&&(a&&!X[f])&&(j=f.replace(ja,ka),i(n.get(j))||(X[f]={})),e=e+"."+f):e=f:(e?(d=(e?e.replace(kb,Ya):e)+"#"+f,j=e+"."+f):j=f?d=f:d="",e=x+(d?"."+d:""),a&&(!X[d]&&e!=x&&!i(n.get(j)))&&(X[d]={}));return!b?e:e?e+"."+b:b},toLogicalPath:G=function(b){var a;return b===
x?"*":(a=Aa.exec(b))?(b=H.rightContext,a=a[1].replace(ja,ka),G(a+"*"+b)):b},mergePath:v=function(b,a,d){if("_"==a||"_"==b)return"_";b=y(b);if(!i(a)&&null!==a&&(a+="",a.startsWith("/")))return a.substr(1);i(d)&&(d=!0);d&&(a&&b&&!Sa.test(a))&&(a="."+a);if(!a||"."==a)return b;if(Sa.test(a)){if(d=hb.exec(a)){for(var a=1+(d[1]?d[1].length:0),e=H.rightContext;a;)b=Da(b),a--;return e?b?b+d[2]+e:e:"*"===d[2]?b+"*":b}if(d=ib.exec(a))return v(za(b),d[1])}else return a;return b+a},isUndefined:i=function(b){return b===
r},isPrimitive:U=function(b){return null===b||typeof b in cb},isString:k=function(b){return"string"===typeof b},isObject:q=function(b){return"object"===g.type(b)},isBoolean:S=function(b){return"boolean"===typeof b},toTypedValue:ea=function(b){if(k(b)){b=g.trim(b);try{b="true"===b?!0:"false"===b?!1:"null"===b?null:"undefined"===b?r:ua(b)?parseFloat(b):gb.test(b)?g.parseJSON(b):b}catch(a){}}return b},isPromise:V=function(b){return!(!b||!b.promise||!b.done||!b.fail)},clearObj:Ta=function(b){if(U(b))return null;
for(var a in b)eb.call(b,a)&&(b[a]=Ta(b[a]));return b},clone:function(b,a){return U(b)?b:F(b)?b.slice(0):m(b)?b:l(!!a,{},b)},local:function(b,a){if(1==arguments.length)return JSON.parse(localStorage.getItem(b));i(a)?localStorage.removeItem(b):localStorage.setItem(b,JSON.stringify(a))},toString:function(b){return null===b||b===r?"":""+b},encodeHtml:function(b){var a=document.createElement("div");a.appendChild(document.createTextNode(b));return a.innerHTML},_referenceTable:A},onAddOrUpdateNode:function(b){return b?
(J.push(b),this):J},onDeleteNode:function(b){return b?(fa.push(b),this):fa},options:E});var fa=[function(b){var a,d,e=G(b);for(a in A)Ca(b,a);for(a in A)a.startsWith(b)&&delete A[a];for(d in X)b=x+"."+d,a=G(b),(a==e||a.startsWith(e+"*")||a.startsWith(e+"."))&&n.del(b)}];g(["get","set","del","extend"]).each(function(b,a){h[a]=function(){return n[a].apply(n,o.call(arguments))}});n=h();P.hmData=function(b,a){var d=this.data("hmData");if(0===arguments.length)return d;if(1===arguments.length)return d&&
d[b];i(d)&&this.data("hmData",d={});d[b]=a};var O,L=/[ ]+/,Ia=/\*\.$/,ab=/\.|\*/g,w,nb=0,ob=/init(\d*)/,ba=["get","set","convert","finalize","initialize"];Z.prototype={constructor:Z,isDependent:function(){return!this.publisher.path.startsWith(this.originalPublisher.path)},stopPropagation:function(){this.isPropagationStopped=z},stopImmediatePropagation:function(){this.isCascadeStopped=this.isPropagationStopped=this.isImmediatePropagationStopped=z},stopCascade:function(){this.isCascadeStopped=z},error:function(){this.hasError=
z},isCascadeStopped:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,hasError:Y,level:0};p=function(b,a,d,e,f){e=new Z(b,a,d,e,f);Ha(e);if(!e.isPropagationStopped()&&e.publisher.path){e.isDependent()&&(e.originalPublisher.path=e.publisher.path);do e.publisher.path=e.publisher.pathContext(),e.level++,e.type=e.originalType+"."+e.level,Ha(e);while(!e.isPropagationStopped()&&e.publisher.path)}e.type=d;e.originalPublisher.path=a;e.publisher.path=b;return e};var wa=function(b,a){k(b)&&(b=y(b));
for(var d=[],e=0,f;e<I.length;e++)f=I[e],a(f,b)&&d.push(f);return d},I=[];w={getByPublisher:function(b){return wa(b,function(a,b){return a.publisher==b})},getBySubscriber:function(b){return wa(b,function(a,b){return a.subscriber==b})},getBy:function(b){return wa(b,function(a,b){return a.subscriber==b||a.publisher==b})},getAll:function(){return I},add:function(b,a,d,e){if(k(a))for(var f=d.split(L),j=0;j<f.length;j++){var g=this.special[f[j]];g&&g.setup&&g.setup(b,a)}I.push({publisher:a,subscriber:b,
eventTypes:d,workflow:e})},removeBy:function(b){var a,d,e,f=[];for(a=I.length-1;0<=a;a--)if(e=I[a],d=e.workflow,b===e.publisher||b===e.subscriber||k(b)&&(k(e.publisher)&&e.publisher.startsWith(b+".")||k(e.subscriber)&&e.subscriber.startsWith(b+".")))k(e.publisher)||(d.delegateSelector?g(e.publisher).undelegate(d.delegateSelector,e.eventTypes,N):g(e.publisher).unbind(e.eventTypes,N)),f.push(I.splice(a,1)[0]);for(a=f.length-1;0<=a;a--)if(e=f[a],k(e.publisher))for(var j=e.eventTypes.split(L),b=0;b<j.length;b++)(d=
this.special[j[b]])&&d.teardown&&d.teardown(e.subscriber,e.publisher)},special:{}};l(h,{trigger:p,subscription:w,sub:function(b,a,d,e,f,j){b instanceof h&&(b=b.path);a instanceof h&&(a=a.path);k(b)&&b.startsWith("$")&&(b=g(b.substr(1)));if(b&&b.jquery)if(!b.length&&!b.selector)b=null;else{b.each(function(b,g){h.sub(g,a,d,e,f,j)});return}k(a)&&a.startsWith("$")&&(a=g(a.substr(1)));if(a&&a.jquery)a.each(function(a,g){h.sub(b,g,d,e,f,j)});else{if(!a&&""!==a)throw"publisher can not be null";if(!d)throw"eventTypes can not be null";
if("_"===b||"null"==b||null===b)b=M;"_"===f&&(f=r);var i=k(a),l=k(b);K.mark(a);K.mark(b);i&&(a=y(a));l&&(b=y(b));if(i){var n=a,m=d,o=b,i=f,s,p,q,t;t=m.split(" ");for(var u=0;u<t.length;u++)if(l=ob.exec(t[u])){p=t[u];s=+l[1];t.splice(u,1);m=t.join(" ");break}q=Ja(e,n,o,i);m&&w.add(o,n,m,q);p&&(m=function(){var a=new Z(n,n,p);$(B(o),q,a)},s?setTimeout(m,s):m())}else(s=a,i=d,l=b,t=f,u=i.split(" "),u.contains("init")&&(m=!0,i=u.remove("init").join(" ")),u=Ja(e,s,l,t),t={workflow:u,subscriber:l},i)?(i=
Ga(i,s,l),j?(u.delegateSelector=j,g(s).delegate(j,i,t,N)):g(s).bind(i,t,N),w.add(l,s,i,u),m&&(j?g(s).find(j).trigger(i):g(s).trigger(i))):m&&(g(s).one("init",t,N),g(s).trigger("init"))}},handle:function(){return this.sub.apply(this,[null].concat(o.call(arguments)))},workflowType:function(b,a){if(q(b))for(var d in b)O[d]=Ka(b[d]);else return i(b)?O:i(a)?O[b]:O[b]=Ka(a)},activity:{initialize:{},get:{getMember:Ea,getOriginal:function(b){return b.originalPublisher.get()},skipGet:z},set:{setMember:Fa,
skipSet:g.noop},convert:{toString:C.toString,toTypedValue:C.toTypedValue,toNumber:function(b){return+b},toDate:function(b){return new Date(b)}},finalize:{}}});O={triggerChange:{get:function(b){n.triggerChange(b.workflow.options)}},saveLocal:{get:function(b){var a=b.publisher.path;setTimeout(function(){h(a).saveLocal()},1)}}};var K={getId:function(b){return g(b).hmData("viewId")},unMark:function(b){g(b).hmData("viewId",r)},mark:function(b){q(b)&&!g(b).hmData("viewId")&&g(b).hmData("viewId",++nb)}};
h.onDeleteNode(La);l(oa,{trigger:function(b,a,d,e){if(!arguments.length)throw"missing arguments";3>=arguments.length&&(e=d,d=a,a=b,b="");var f=this.physicalPath(b);p(f,f,a,d,e);return this},triggerChange:function(b){var a=this.physicalPath(b),b=this.get(b);p(a,a,"afterUpdate",b,b);return this},sub:function(b,a,d,e,f){h.sub(this.path,b,a,d,e,f);return this},handle:function(b,a,d,e){h.sub(null,this,b,a,d,e);return this},subBy:function(b,a,d,e,f){h.sub(b,this.path,a,d,e,f);return this},subsToMe:function(){return w.getByPublisher(this.path)},
subsFromMe:function(){return w.getBySubscriber(this.path)},subscriptions:function(){return w.getBy(this.path)},mapEvent:function(b,a,d){d=d||z;h.handle(this.path,b,function(b){d.call(this,b)&&b.publisher.trigger(a,b.proposed,b.removed)});return this},cacheable:function(b){h.handle(this.getPath(b),"init after*","*saveLocal");return this}});l(P,{sub:function(b,a,d,e,f){this.length&&h.sub(this,b,a,d,e,f);return this},handle:function(b,a,d,e){this.length&&h.sub(null,this,b,a,d,e);return this},subBy:function(b,
a,d,e,f){this.length&&h.sub(b,this,a,d,e,f);return this},subsToMe:function(){return w.getByPublisher(this[0])},subsFromMe:function(){return w.getBySubscriber(this[0])},subscriptions:function(){return w.getBy(this[0])},initView:function(b,a,d){h.sub(this,b,"init",a,d);return this},mapEvent:function(b,a,d,e){d?m(d)||(e=d,d=z):d=z;return this.handle(b,function(b){if(d.call(this,b)){b.type=a;b.eventData=e;b.publisher.trigger(b)}})}});h.newViewEvent=function(b,a,d){if(q(b)){for(var e in b)h.newViewEvent(e,
b[e][0],b[e][1]);return this}var f=function(a){(!0===d||d.call(this,a))&&g(a.target).trigger(l({},a,{type:b,currentTarget:a.target}))};if(g.event.special[b])throw"event '"+b+"' has been defined";g.event.special[b]={setup:function(){g(this).bind(a,f)},teardown:function(){g(this).unbind(a,f)}};return this};var pb=g.cleanData;g.cleanData=function(b){g(b).each(function(){La(this)});pb(b)};C.getUniqueViewEventTypes=Ga;C._viewHandlerGateway=N;var bb=/([!$]?)([\w \+\-\*\.]+?):([\w\W]+?)\s*(?:[;]\s*|$)/g,
qb=/^([^|]+)(\|(.*))?$/,rb=/\s*\|\s*/g;E.subsAttr="data-sub";E.autoparseSub=!0;D.prototype={importGroup:function(){var b,a,d,e,f=this.groups;for(b=0;b<f.length;b++)d=f[b],a=d.key,e=qb.exec(d.value),d=e[1],e=e[3],a=h.groups[a],m(a)?a(this.elem,v(this.ns,d),this,pa(this.options,e)):k(a)&&new D(a,this,d,e)},importSubscriptions:function(b){var a,d,e,f,g,h=this[b];for(a=0;a<h.length;a++)d=h[a],f=d.key,d=d.value.split(rb),"sub"==b?(e=d[0],e=e.startsWith("$")?e:v(this.ns,e),g=this.elem):(e=this.elem,g=d[0],
g=g.startsWith("$")?g:v(this.ns,g)),this.appendSub(g,e,f,d[1],ea(pa(this.options,d[2])),d[3])},appendSub:function(b,a,d,e,f,g){this.subscriptions.push({publisher:a,eventTypes:d,subscriber:b,handler:e,options:f,delegate:g})},prependSub:function(b,a,d,e,f,g){this.subscriptions.unshift({publisher:a,eventTypes:d,subscriber:b,handler:e,options:f,delegate:g})},clearSubs:function(){this.subscriptions.splice(0,this.subscriptions.length)}};setTimeout(function(){g(function(){E.autoparseSub&&qa(document.documentElement)})},
1);P.parseSub=function(){return this.each(function(){qa(this)})};var Ua=h("*log",[]);l(h,{groups:{code:function(b,a,d,e){n.get(a,b,a,d,e)},preSub:function(b,a,d,e){d.preSub=function(){n.get(a,b,a,d,e)}},postSub:function(b,a,d,e){d.postSub=function(){n.get(a,b,a,d,e)}}},Group:D,log:function(b,a){Ua.push(a?"<div style='color:"+a+"'>"+b+"</div> ":b)},clearlog:function(){Ua.clear()}});var Q,da={},ra={initialize:"*templateOptions",get:"get",convert:"*dataToMarkup",set:"html",finalize:"*parseSub"};h.activity.initialize.templateOptions=
function(b,a,d,e){if(k(e))e=e.split(","),d.templateId=g.trim(e[0]),d.wrapDataInArray="true"==g.trim(e[1]),d.engineName=e[2];else if(q(e)&&e.templateId)l(d,e);else if(!(d.templateId=a.hmData("embeddedTemplate")))if(b=g.trim(a.html()))b=b.replace(sb,tb),d.templateId="__"+g.uuid++,Q.compile(d.templateId,b),a.hmData("embeddedTemplate",d.templateId),a.empty();else throw"missing template";};var sb=/&lt;|&gt;/g,ub={"&lt;":"<","&gt;":">"},tb=function(b){return ub[b]||""};Na.prototype.get=function(){var b=
this.e.publisher;return b.get.apply(b,o.call(arguments))};h.activity.convert.dataToMarkup=function(b,a){if(b&&(F(b)&&b.length||!F(b))){var d=a.workflow,e;var f=d.templateId,j=d.wrapDataInArray?[b]:b;e=new Na(a);var h=Oa(d.engineName,f),f=g.trim(f);if(h.isTemplateLoaded(f))e=h.render(f,j,e);else if(h.renderAsync)e=h.renderAsync(f,j,e);else{var i=g.Deferred(),d=l(!0,{},e.e),m=l(!0,{},d.publisher),n=l(!0,{},e);d.publisher=m;n.e=d;Q.load(f).done(function(){var a=h.render(f,j,n),b=g(a);i.resolve(b.selector||
!b.length?a:b)});e=i.promise()}if(V(e))return e;k(e)&&(e=g.trim(e));return g(g("<div />").html(e)[0].childNodes)}return""};h.activity.finalize.parseSub=function(b){g(b).parseSub()};h.workflowType({renderContent:ra,renderSelf:Ma("get","replaceWith")});l(h.groups,{"for":"!init:.|*renderContent",forSelf:"!init after*.:.|*renderContent",forChildren:"!init after*. after*.1:.|*renderContent",forAll:"!init after*:.|*renderContent",renderSelf:"!init:.|*renderSelf"});P.renderContent=function(b,a,d){a=a||"";
m(d)&&(d={finalize:d});return this.initView(a,d?l({},ra,d):"*renderContent",b)};P.renderSelf=function(b,a,d){m(d)&&(d={finalize:d});return this.initView(a,d?l({},h.workflowType("renderSelf"),d):"*renderSelf",b)};h.template=Q={defaultEngine:"",engineAdapter:function(b,a){if(!b)return da;if(!a)return da[b];a.isTemplateLoaded=a.isTemplateLoaded||z;da[b]=a;Q.defaultEngine=b},load:function(){throw"not implemented";},compile:function(b,a,d){return Oa(d).compile(b,a)},newTemplateWorkflow:Ma};if(g.render&&
g.templates){var xa;Q.engineAdapter("jsrender",xa={render:function(b,a,d){g.render[b]||this.compile(b,document.getElementById(b).innerHTML);return g.render[b](a,d)},compile:function(b,a){g.templates(b,{markup:a,debug:xa.templateDebugMode,allowCode:xa.allowCodeInTemplate})},isTemplateLoaded:function(b){return!!g.render[b]||!!document.getElementById(b)},templateDebugMode:!1,allowCodeInTemplate:!0});var Va=g.views.tags;Va({ts:function a(){return a.enabled?"<span style='color:red' data-sub='show:/*ts'>updated on:"+
(+new Date+"").substring(7,10)+"</span>":""},indexToNs:function(){var a=this.tagCtx.view.index,d=this.ctx.modelPath;i(a)&&(a=this.ctx.e.publisher.count()-1);return"ns:/"+d+"."+a},get:function(){var a=this.ctx.e.publisher;return a.get.apply(a,o.call(arguments))},prop:function(){var a=this.tagCtx.view.index;i(a)&&(a=this.ctx.e.publisher.count()-1);a=this.ctx.e.publisher.cd(a);return a.get.apply(a,o.call(arguments))},keyToNs:function(){return"ns:/"+this.ctx.modelPath+".table."+this.ctx.e.publisher.itemKey(this.tagCtx.view.data)},
dataPathAsNs:function(){return"ns:/"+this.ctx.modelPath}});Va.ts.render.enabled=!0;h("*ts",!1)}"undefined"!=typeof Handlebars&&(h.template.engineAdapter("handlebars",{render:function(a,d,e){return Handlebars.partials[a](d,{data:{renderContext:e}})},compile:function(a,d){Handlebars.registerPartial(a,Handlebars.compile(d))},isTemplateLoaded:function(a){return!!Handlebars.partials[a]}}),Handlebars.registerHelper("modelPath",function(a){return a.data.renderContext.modelPath}),Handlebars.registerHelper("indexToNs",
function(a){return"ns:/"+a.data.renderContext.modelPath+"."+a.data.index+";"}),Handlebars.registerHelper("keyToNs",function(a){a=a.data.renderContext;return"ns:/"+a.modelPath+".table."+a.e.publisher.itemKey(this)}),Handlebars.registerHelper("get",function(){var a=arguments,d=a.length-1,e=a[d].data.renderContext;return e.get.apply(e,o.call(a,0,d))}),Handlebars.registerHelper("prop",function(){var a=[].slice,d=arguments,e=d.length-1,f=d[e].data,f=f.renderContext.e.publisher.cd(f.index);return f.get.apply(f,
a.call(d,0,e))}),g(function(){g("script[type=handlebars]").each(function(){Handlebars.registerPartial(this.id,Handlebars.compile(g(this)[0].innerHTML))})}));var R=[{name:"textBoxOrDropDown",get:function(a){return a.val()},set:function(a,d){a.val()!==d&&a.val(d)},match:z},{name:"checkbox",get:Pa,set:function(a,d){var e=a[0];e.checked=S(d)?d:d==e.value},match:function(a){return a.is(":checkbox")}},{name:"radio",get:Pa,set:function(a,d,e){a=a[0];if(!a.name)a.name=e.publisher.path;a.checked=C.toString(d)==
a.value},match:function(a){return a.is(":radio")}},{name:"listBox",get:function(a){var d=[];a.children("option:selected").each(function(){d.push(this.value)});return d},set:function(a,d){function e(){if(this.value==g)this.selected=true}a.children("option:selected").removeAttr("selected");for(var f=0,g;f<d.length;f++){g=d[f];a.children("option").each(e)}},match:function(a){return a.is("select[multiple]")}}];h.activity.get.getViewValue=function(a){return a.workflow.getViewValue(a.publisher)};h.activity.set.setViewValue=
function(a,d){return d.workflow.setViewValue(this,a,d)};h.workflowType({updateViewValue:{initialize:function(a,d,e,f){Qa(d,e,f,"set")},get:"get",set:"*setViewValue"},updateModelValue:{initialize:function(a,d,e,f){Qa(a,e,f,"get")},get:"*getViewValue",set:"set"}});h.valueAdapter=function(a){if(a)R.push(a);else return R};h.groups.val=function(a,d,e,f){var g,h,i;if(f=f||""){f=f.split(",");h=f[0]||"change";g=f[1];i=f[2]}else h="change";(!g||g=="updateView")&&e.appendSub(a,d,"init1 after*","*updateViewValue",
i);(!g||g=="updateModel")&&e.appendSub(d,a,h+" resetVal","*updateModelValue",i)};h.groups.resetFormValues=function(a){function d(){e.find(":input").trigger("resetVal")}var e=g(a);e.bind("reset",function(){setTimeout(d,1)})};E.confirmMessage="Are you sure?";h.activity.get.compareTruthy=function(a){var d=a.workflow.options,a=a.publisher;return i(d)?!a.isEmpty():a.compare(d)};h.activity.initialize.extractClass=function(a,d,e,f){a=f.split(",");e.className=a[0];e.options=a[1]};var Wa={options:["!init after*:.|*options",
{get:function(a){var d=a.workflow.options,e=this.val();this.children("option[listItem]").remove().end().append(function(){var e="";g(a.publisher.get()).each(function(){e=e+("<option listItem='1' value='"+d.value(this)+"'>"+d.name(this)+"</option>")});return e}).val(e);this.val()!==e&&g(this.trigger("change"))},initialize:function(a,d,e,f){if(f){var a=f.split(","),g=a[0],h=a[1]||a[0];e.options={name:function(a){return a[g]},value:function(a){return a[h]}}}else e.options={name:function(a){return a.toString()},
value:function(a){return a.toString()}}}}],show:["!init after*:.|*show",{get:"*compareTruthy",set:function(a){this[a?"show":"hide"]()}}],hide:["!init after*:.|*hide",{get:"*compareTruthy",set:function(a){this[a?"hide":"show"]()}}],enable:["!init after*:.|*enable",{get:"*compareTruthy",set:function(a){this.attr("disabled",!a)}}],disable:["!init after*:.|*disable",{get:"*compareTruthy",set:function(a){this.attr("disabled",a)}}],addClass:["!init after*:.|*addClass",{initialize:"*extractClass",get:"*compareTruthy",
set:function(a,d){this[a?"addClass":"removeClass"](d.workflow.className)}}],removeClass:["!init after*:.|*removeClass",{initialize:"*extractClass",get:"*compareTruthy",set:function(a,d){this[a?"removeClass":"addClass"](d.workflow.className)}}],toggleClass:["!init after*:.|*toggleClass",{get:function(a){var d,e,f=a.publisher.get(),g=a.workflow.options;if(g){if(g.startsWith("!")){e=true;g=g.substr(1)}d=f^e?"addClass":"removeClass"}if(a.type=="init")if(g)this[d](g);else this.addClass(f);else if(g)this[d](g);
else this.removeClass(a.removed).addClass(f)}}],focus:["!init after*:.|*focus",{get:"*compareTruthy",set:function(a){if(a){var d=this;setTimeout(function(){d.focus().select()},1)}}}],count:["!init after*:.|*count",function(a){a=a.publisher.get();this.text("length"in a?a.length:a)}],dump:["!init *:.|*dump",function(a){a.type.startsWith("before")||this.html("<span style='color:red'>"+a.publisher.path+" : "+a.publisher.toJSON()+"</span>")}],alert:["$click:.|*alert",function(a){alert(i(a.workflow.options)?
this.get():a.workflow.options)}],preventDefault:["$click:_|*preventDefault",function(a){a.preventDefault()}],stopPropagation:["$click:_|*stopPropagation",function(a){a.stopPropagation()}],confirm:[function(a,d,e,f){h.sub(d,a,"click","*confirm",f)},function(a){var d=i(a.workflow.options)?this&&this.get&&this.get()||E.confirmMessage:a.workflow.options;if(!confirm(d)){a.stopImmediatePropagation();a.preventDefault&&a.preventDefault()}}],hardCode:["$click:.|*hardCode",{initialize:function(a,d,e,f){e.hardCode=
ea(f)},get:function(a){this.set(a.workflow.hardCode)}}],"0":["$click:.|*0",function(){this.set(0)}],emptyString:["$click:.|*empty",function(){this.set("")}],"null":["$click:.|*null",function(){this.set(null)}],"true":["$click:.|*true",function(){this.set(true)}],"++":["$click:.|*++",function(){this.set(this.get()+1)}],"--":["$click:.|*--",function(){this.set(this.get()-1)}],"false":["$click:.|*false",function(){this.set(false)}],toggle:["$click:.|*toggle",function(){this.set(!this.get())}],sortItems:["$click:.|*sortItems",
{initialize:function(a,d,e,f){f=(f||"")&&f.split(",");e.by=f[0];e.asc=!!f[1]},get:function(a){a=a.workflow;this.sort(a.by,a.asc);a.asc=!a.asc}}],clear:["$click:.|*clear",function(){this.clear()}],del:["$click:.|*del;confirm:_|_Do you want to delete this item?",function(){this.del()}]},ga;for(ga in Wa){var Xa=Wa[ga];h.groups[ga]=Xa[0];h.workflowType(ga,Xa[1])}l(h.groups,{caption:function(a,d,e,f){g(a).prepend("<option value=''>"+(f||h.get(d))+"</option>")},autofocus:function(a){setTimeout(function(){g(a).focus()},
1)},mapEvent:function(a,d,e,f){f=f.split(",");g(a).mapEvent(f[0],f[1],f[2])},mapClick:function(a,d,e,f){f=f.split(",");g(a).mapEvent("click",f[0],f[1])},logPanel:function(a,d,e){var a=g(a),f=a.is("ol")?a:g("<ol style='font-family: monospace, serif' />").appendTo(a),a=f[0];e.appendSub(a,"*log","init",function(a){for(var a=a.publisher.get(),d=0;d<a.length;d++)f.append("<li>"+a[d]+"</li>")});e.appendSub(a,"*log","afterCreate.1",function(a){f.append("<li>"+a.originalPublisher.raw()+"</li>")});e.appendSub(a,
"*log","afterCreate",function(){f.empty()})},clearlog:"clear:/*log",enableLater:"!after*:.|*enable",disableLater:"!after*:.|*disable",html:"!init after*:.|get html *toString",text:"!init after*:.|get text *toString"});h.newViewEvent({enter:["keyup",function(a){return a.keyCode===13}],esc:["keyup",function(a){return a.keyCode===27}],ctrlclick:["click",function(a){return a.ctrlKey}]})})(jQuery,window);
