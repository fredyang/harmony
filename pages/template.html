<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Template</title>
	<script src="../ref/modernizr-2.6.2.min.js"></script>
	<link href="doc.css" rel='stylesheet'/>

</head>
<body>
<!--[if lt IE 7]>
<p class="chrome">You are using an <strong>outdated</strong> browser. Please <a
	href="http://browsehappy.com/">upgrade your browser</a> or <a
	href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to
	improve your experience.</p>
<![endif]-->
<div class="page fixedHead">
<div class="head  title">
	<header>
		<h1><a class="linkButton" href="../index.html">Harmony</a></h1>

		<p>where model and view should live in</p>
	</header>

	<nav class="hlist">
		<a href="../index.html" class="selected">Home</a>

		<a href="doc.html">Documentation</a>
		<a href="//github.com/fredyang/Harmony">Source on GitHub</a>

		<div class="g-plusone" data-annotation="standard" data-width="300"></div>

	</nav>

</div>


<div class="body">
<div class="leftCol">

	<div class="mod  ">
		<div class="hd">
			Introduction
		</div>

		<div class="bd">
			<nav class="vlist">
				<a href="../index.html">Get started</a>
				<a href="Model.html">Model</a>
				<a href="Subscription.html">Unified Subscription</a>
				<a href="workflowActivity.html">Workflow/activity</a>
				<a href="template.html">Template</a>
				<a href="examples.html">Examples</a>
			</nav>
		</div>
	</div>


</div>

<div class="main">
	<h2>Template</h2>


	<p>Harmony does not have a template engine, instead it uses template adapters to call
		other template engine. It comes with two
		template adapters, one for <a
			href="https://github.com/BorisMoore/jsrender">jsrender</a>,
		one for <a href="https://github.com/wycats/handlebars.js">handlebars.js</a>.
		If your template favorite engine is not one of them, you can <a
			href="/harmony/pages/doc.html#api.apiAction=view&api.selectedEntryName=Core.Template.engine+adapter">
			implement
		</a> an adapter for your favorite one. The follow example renders a view
		using jsRender adapter.
	</p>

<pre data-sub="prettyprint:_;preview:_|http://jsbin.com/owadim/7">
&lt;body&gt;
  &lt;table&gt;
    &lt;tr&gt;
      &lt;td&gt;First Name&lt;/td&gt;
      &lt;td&gt;Last Name&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tbody data-sub="for:contacts|contactRow"&gt;
	&lt;/tbody&gt;
  &lt;/table&gt;
  &lt;script type="jsrender" id="contactRow"&gt;
	&lt;tr&gt;
		&lt;td&gt;{{:firstName}}&lt;/td&gt;
		&lt;td&gt;{{:lastName}}&lt;/td&gt;
	&lt;/tr&gt;
  &lt;/script&gt;
&lt;/body&gt;
</pre>
	<p>If objects react but not act, how a view can be rendered? It turns out the
		view render itself. The "for" subscription group registers a
		subscription for a special event <a
			href="/harmony/pages/doc.html#api.apiAction=view&api.selectedEntryName=Core.Unified+Subscription.Subscription.init+event">init</a>
		with a template workflow called
		"renderContent". The "init" event will be triggered when the subscription is
		registered, so the workflow will be executed. In above example, the workflow render
		some mark-up using data in "contacts" and template "contactRow", and the view replace
		its content with the markup.
	</p>

	<h3>How template workflow works</h3>

	<p>A template workflow consists of five activities. In the case here, the
		"renderContent"
		activit is as follow:</p>

<pre data-sub="prettyprint:_">
renderContent = {
 initialize: "*templateOptions",
 get: "get", //extensible
 convert: "*dataToMarkup",
 set: "html", //extensible
 finalize: "*parseSub"
};
</pre>
	<p>When a subscription is registered with a template workflow, the "initialize" activity
		"*templateOptions" fetch an workflow instance with a template id. When event
		triggered,the workflow instance uses "get" activity "get" to get data in model
		repository, then uses "convert" activity "*dataToMarkup" to convert the data into
		markup
		with the template, then use set activity "html" to replace view's content with
		mark-up,
		and finally uses "finalize" activity to "*parseSub" to register the declarative
		subscriptions embedded in
		the markup. </p>

	<p>In the above example, the output content of the workflow is static. In the following
		example, the output content contains declarative subscriptions, which will be
		automatically registered by the finalize activity "*parseSub", so the output
		content is responsive to view event and model event.

		<strong> This "*parseSub" activity is one of the most important reason to use
			declarative
			subscription.</strong>

		Without this, it will be cumbersome to register subscriptions programmatically again
		and
		again. With this, it is possible that child view can render its descendant views,
		and so
		far and so
		on.
	</p>

<pre data-sub="prettyprint:_;preview:_|http://jsbin.com/ucexiy/3">
&lt;tbody data-sub="ns:contacts;
                  listView:.|contactRow;
                  movableRow:.;
                  $delete:.|*removeItem;"&gt;&lt;/tbody&gt;
&lt;/table&gt;

&lt;script type="jsrender" id="contactRow"&gt;
  &lt;tr data-sub="{{keyToNs /}}"&gt;
    &lt;td&gt;&lt;input type="text" data-sub="val:firstName" /&gt;&lt;/td&gt;
    &lt;td&gt;&lt;input type="text" data-sub="val:lastName" /&gt;&lt;/td&gt;
    &lt;td&gt;
      &lt;input type="button" value="delete" data-sub="del:." /&gt;
      &lt;input type="button" value="move up" class="moveUp" /&gt;
      &lt;input type="button" value="move down" class="moveDown" /&gt;
	&lt;/td&gt;
  &lt;/tr&gt;
&lt;/script&gt;
</pre>

	<h3>Render a &lt;body /&gt; with template</h3>

	<p>Thanks to the "*parseSub" activity of template workflow, root view &lt;body /&gt; can
		build its child views using template workflow, and recursively the child views can
		build
		their own child views. Eventually, whole view can be built. The following is
		refactory of the above example. The difference is that, the body is empty
		initially. </p>

<pre data-sub="prettyprint:_;preview:_|http://jsbin.com/ikopaw/1">

&lt;body data-sub="for:/|rootView"&gt;&lt;/body&gt;
</pre>

	<h3>Embedded template, external template and inline template.</h3>

	<p>
		In previous examples, the templates are called embedded template because
		they are embedded in the page script tags, they can be reused in the page because
		they can be reference by Ids.
	</p>

	<p>
		If you have templates which can be reused across the pages or you don't want
		to embedded into the page like previous example, you can move your templates
		in external files. But you don't need to change a single lines of code because of
		this. The library can dynamically load the external template before
		rendering. The following is refactory of previous example. The external template
		file is <a href="">here</a>
	</p>
<pre data-sub="prettyprint:_;preview:_|http://jsbin.com/ikopaw/2">

&lt;body data-sub="for:/|rootView"&gt;&lt;/body&gt;
</pre>


	<p>
		If your template is simple and not meant to be reused, you can put them in inside of
		the view container, like the following. This kind of template is called inline template.
	</p>

<pre data-sub="prettyprint:_;preview:_|http://jsbin.com/ejeten/2">
&lt;table&gt;
  &lt;tr&gt;
    &lt;td&gt;First Name&lt;/td&gt;
    &lt;td&gt;Last Name&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tbody data-sub="for:app.contacts"&gt;
    &lt;tr&gt;
      &lt;td&gt;{{:firstName}}&lt;/td&gt;
      &lt;td&gt;{{:lastName}}&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</pre>


	<h3>What is next?</h3>

	<p>
		This is wrap for an overview of the library. For more information about the library
		and the bundled plugins, please refer to <a
		href="/harmony/pages/doc.html">documentation</a>.
		There are lots example in the documentation, and they are hosted in <a
		href="http://jsbin.com">jsbin.com</a>. Because of that, they are fully hackable. You
		can change the code directly, the original code will not be effected. Great thanks
		to <a href="http://jsbin.com">
		jsbin.com</a>. You can report bugs and discuss features on the <a
		href="https://github.com/fredyang/Harmony/issues">GitHub
		issues page.</a>
	</p>

</div>
</div>
<div class="footer   title">
	<p class="fR man">&copy; Fred Yang - <a href="http://semanticsworks.com">http://semanticsworks.com</a>
	</p>
</div>
</div>
</div>
<script src="../ref/jquery.js"></script>
<script src="../ref/jsrender.js"></script>
<script src="../ref/jquery.ba-bbq.min.js"></script>
<script src="../download/harmony.debug.js"></script>
<script src="../ref/matrix.min.js"></script>
<script src="../assets/js/doc.js"></script>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>


</body>
</html>
